<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,user-scalable=no">
<style>#c{background:white;margin:auto;display:block;cursor:url(http://www.rw-designer.com/cursor-view/128661.png);}</style>
</head>
<body>
<canvas id="c" width="680" height="480">
</canvas>
<script>
g = (e) => [...Array(e).keys()];
const w = 680, h = 480;
var attemptleft = 100;
var canvas = document.getElementById("c"),
    c = canvas.getContext("2d"),
    phtmr = null,
    started = 0,
    pos = { x: w / 2, y: h / 2 },
    o = [],
    b = [],
    sc = 0,
    sco = 0;
function ci(e, r, s, t) {
    c.beginPath(), c.ellipse(e, r, s, s, 0.79, 0, 6.27), c.fill(), c.beginPath(), c.ellipse(e, r, s + 5, s + 5, 0.79, 0, 6.27), t && c.stroke();
}
function drlp() {
    for (ob of (c.clearRect(0, 0, w, h), (c.lineWidth = 2), (c.strokeStyle = "black"), o)) c.strokeRect(ob.x - 5, ob.y - 5 + sc, 10, 10);
    for (bo of ((c.lineWidth = 1), (c.strokeStyle = c.fillStyle = "black"), ci(pos.x, pos.y, 10, 1), (c.fillStyle = "black"), b)) ci(bo.x, bo.y + sc, 7);
    (c.font = "35px Cursive"), c.fillText(sco, 20, 40), window.requestAnimationFrame(drlp);
}
function die() {
if (attemptleft <= 0) {
alert('Game over!');
location.reload();
}
attemptleft = attemptleft-1;
return 0;
}
function dist(e, r) {
    return (x = e.x - r.x), (y = e.y - r.y), Math.sqrt(x * x + y * y);
}
function phl() {
    for (ob of ((pos.x += vel.x),
    (pos.y += vel.y),
    (vel.x *= 0.99),
    (vel.y += 0.1),
    (ns = sc + speed + (pos.y < h / 2 ? 3 - pos.y / (h / 6) : 0)),
    speed < 4 && (speed += 0.0001),
    ~~(sc / 300) != ~~(ns / 300) && spwn(~~(9 * ra())),
    (sc = ns),
    pos.y > h && die(),
    o))
        dist(scr(ob, 1), pos) < 29 && die();
    b = b.filter((e) => dist(scr(e, 1), pos) > 23 || (sco++ && !1));
}
function spwn(e) {
    for (i of ((fl = ra() > 0.5), chunks_o[e])) o.push(scr_a(i, -1, fl));
    for (i of chunks_b[e]) b.push(scr_a(i, -1, fl));
}
function strt() {
    (phtmr = setInterval(phl, 20)), spwn(0);
}
(speed = 1),
    (vel = { x: 0, y: 0 }),
    (chunks_o = [
        [
            [0.8, 0],
            [0.56, 0],
            [0.7, 3],
            [0.5, 3],
            [0.4, 6],
            [0.45, 6],
        ],
        [
            [0.5, 0],
            [0.8, 3],
            [0.5, 6],
        ],
        [
            [0.34, 0],
            [0.5, 0],
            [0.12, 0],
        ],
        g(8).map((e) => [0.1 + 0.1 * e, 2 * e]),
        g(6).map((e) => [0.1 + 0.1 * e, 0]),
        g(5).map((e) => [0.25, 2 * e]),
        g(5).map((e) => [1 / 6 + e / 6, 0]),
        g(6)
            .map((e) => [1 / 3 + e / 15, 0])
            .concat(g(6).map((e) => [1 / 3 + e / 15, 18])),
        g(16).map((e) => [0.06 + e / 17, (~~e % 4) * 4]),
    ]),
    (chunks_b = [
        [[0.5, 3]],
        [
            [0.25, 3],
            [0.74, 3],
        ],
        [],
        [],
        [[0.2, 0]],
        [[0.21, 5]],
        g(5).map((e) => [1 / 6 + e / 6, 2]),
        g(6).map((e) => [1 / 3 + e / 15, 8]),
        [[0.5, 6]],
    ]),
    (ra = Math.random),
    (scr_a = (e, r, s) => ({ x: s ? e[0] * w : w - e[0] * w, y: 10 * -e[1] + r * sc })),
    (scr = (e, r) => ({ x: e.x, y: e.y + r * sc })),
    canvas.addEventListener("mousedown", function (e) {
        (vel.x = ((e.clientX - canvas.getBoundingClientRect().left) / w) * 10 - 5), (vel.y = (-5 * pos.y) / h), !started && ((started = 1), strt());
    }),
    drlp();
</script>
<script>
function fullscreen() {
let c = document.getElementById('c');
c.requestFullscreen();
screen.orientation.lock("landscape");
}
document.addEventListener('click', fullscreen);
</script>
</body>
</html>
